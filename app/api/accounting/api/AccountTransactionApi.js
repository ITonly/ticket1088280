/**
 * GuanPlus.Accounting.WebApi
 *
 * OpenAPI spec version: v1
 *
 *
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 * Do not edit the class manually.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var http_1 = require("@angular/http");
var core_1 = require("@angular/core");
var variables_1 = require("../variables");
require("rxjs/Rx");
/* tslint:disable:no-unused-variable member-ordering */
var AccountTransactionApi = (function () {
    function AccountTransactionApi(http, basePath) {
        this.http = http;
        this.basePath = 'http://guanplus-api-accounting-dev.cn-north-1.eb.amazonaws.com.cn';
        this.defaultHeaders = new http_1.Headers();
        if (basePath) {
            this.basePath = basePath;
        }
    }
    /**
     * 根据id 删除交易记录
     *
     * @param id
     */
    AccountTransactionApi.prototype.accountTransactionDelete = function (id, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/${id}'
            .replace('${' + 'id' + '}', String(id));
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'id' is not null or undefined
        if (id === null || id === undefined) {
            throw new Error('Required parameter id was null or undefined' +
                'when calling accountTransactionDelete.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Delete,
            headers: headerParams,
            search: queryParameters
        };
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 根据id获取交易记录
     *
     * @param id
     */
    AccountTransactionApi.prototype.accountTransactionGet = function (id, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/${id}'
            .replace('${' + 'id' + '}', String(id));
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'id' is not null or undefined
        if (id === null || id === undefined) {
            throw new Error('Required parameter id was null or undefined' +
                'when calling accountTransactionGet.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Get,
            headers: headerParams,
            search: queryParameters
        };
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 上传流水帐附件
     *
     * @param accountTransactionId
     */
    AccountTransactionApi.prototype.accountTransactionMobileUpload = function (accountTransactionId, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/mobile/upload/${accountTransactionId}'
            .replace('${' + 'accountTransactionId' + '}', String(accountTransactionId));
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'accountTransactionId' is not null or undefined
        if (accountTransactionId === null || accountTransactionId === undefined) {
            throw new Error('Required parameter accountTransactionId was null or undefined' +
                'when calling accountTransactionMobileUpload.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Post,
            headers: headerParams,
            search: queryParameters
        };
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 新增交易记录
     *
     * @param accountTransactionModel
     */
    AccountTransactionApi.prototype.accountTransactionPost = function (accountTransactionModel, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction';
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'accountTransactionModel' is not null or undefined
        if (accountTransactionModel === null || accountTransactionModel === undefined) {
            throw new Error('Required parameter accountTransactionModel was null or undefined' +
                'when calling accountTransactionPost.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Post,
            headers: headerParams,
            search: queryParameters
        };
        requestOptions.body = JSON.stringify(accountTransactionModel);
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 修改交易记录
     *
     * @param accountTransactionModel
     */
    AccountTransactionApi.prototype.accountTransactionPut = function (accountTransactionModel, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction';
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'accountTransactionModel' is not null or undefined
        if (accountTransactionModel === null || accountTransactionModel === undefined) {
            throw new Error('Required parameter accountTransactionModel was null or undefined' +
                'when calling accountTransactionPut.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Put,
            headers: headerParams,
            search: queryParameters
        };
        requestOptions.body = JSON.stringify(accountTransactionModel);
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 根据id撤销收支记录
     *
     * @param accountTransactionIds 收支记录id集合
     */
    AccountTransactionApi.prototype.accountTransactionRevoke = function (accountTransactionIds, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/revoke';
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'accountTransactionIds' is not null or undefined
        if (accountTransactionIds === null || accountTransactionIds === undefined) {
            throw new Error('Required parameter accountTransactionIds was null or undefined' +
                'when calling accountTransactionRevoke.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Post,
            headers: headerParams,
            search: queryParameters
        };
        requestOptions.body = JSON.stringify(accountTransactionIds);
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 分页获取交易记录
     *
     * @param bankaccountid 银行账户Id
     * @param accountTransactionType 交易类型：0、全部；1、收入；2、支出
     * @param keyword 关键字
     * @param money 金额
     * @param startDate 开始时间
     * @param endDate 结束时间
     * @param includeChildren 是否带子项Y/N
     * @param statementStatus 对账状态：0或者空字符串&#x3D;全部；1&#x3D;未对账；2&#x3D;已经对账
     * @param matchMoney 匹配金额
     * @param pageIndex 页数索引
     * @param pageSize 页数大小
     */
    AccountTransactionApi.prototype.accountTransactionSearch = function (bankaccountid, accountTransactionType, keyword, money, startDate, endDate, includeChildren, statementStatus, matchMoney, pageIndex, pageSize, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/search/${bankaccountid}'
            .replace('${' + 'bankaccountid' + '}', String(bankaccountid));
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'bankaccountid' is not null or undefined
        if (bankaccountid === null || bankaccountid === undefined) {
            throw new Error('Required parameter bankaccountid was null or undefined' +
                'when calling accountTransactionSearch.');
        }
        if (accountTransactionType !== undefined) {
            queryParameters.set('accountTransactionType', String(accountTransactionType));
        }
        if (keyword !== undefined) {
            queryParameters.set('keyword', String(keyword));
        }
        if (money !== undefined) {
            queryParameters.set('money', String(money));
        }
        if (startDate !== undefined) {
            queryParameters.set('startDate', String(startDate));
        }
        if (endDate !== undefined) {
            queryParameters.set('endDate', String(endDate));
        }
        if (includeChildren !== undefined) {
            queryParameters.set('includeChildren', String(includeChildren));
        }
        if (statementStatus !== undefined) {
            queryParameters.set('statementStatus', String(statementStatus));
        }
        if (matchMoney !== undefined) {
            queryParameters.set('matchMoney', String(matchMoney));
        }
        if (pageIndex !== undefined) {
            queryParameters.set('pageIndex', String(pageIndex));
        }
        if (pageSize !== undefined) {
            queryParameters.set('pageSize', String(pageSize));
        }
        var requestOptions = {
            method: http_1.RequestMethod.Get,
            headers: headerParams,
            search: queryParameters
        };
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 上传流水帐附件
     *
     * @param accountTransactionId
     */
    AccountTransactionApi.prototype.accountTransactionUpload = function (accountTransactionId, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/upload/${accountTransactionId}'
            .replace('${' + 'accountTransactionId' + '}', String(accountTransactionId));
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'accountTransactionId' is not null or undefined
        if (accountTransactionId === null || accountTransactionId === undefined) {
            throw new Error('Required parameter accountTransactionId was null or undefined' +
                'when calling accountTransactionUpload.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Post,
            headers: headerParams,
            search: queryParameters
        };
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    /**
     * 获取水印
     *
     * @param attachmentId 附件id
     * @param accountTransactionId 交易记录id
     */
    AccountTransactionApi.prototype.accountTransactionWaterMark = function (attachmentId, accountTransactionId, extraHttpRequestParams) {
        var path = this.basePath + '/api/v1/account_transaction/${attachmentId}/${accountTransactionId}/watermark'
            .replace('${' + 'attachmentId' + '}', String(attachmentId))
            .replace('${' + 'accountTransactionId' + '}', String(accountTransactionId));
        var queryParameters = new http_1.URLSearchParams();
        var headerParams = this.defaultHeaders;
        // verify required parameter 'attachmentId' is not null or undefined
        if (attachmentId === null || attachmentId === undefined) {
            throw new Error('Required parameter attachmentId was null or undefined' +
                'when calling accountTransactionWaterMark.');
        }
        // verify required parameter 'accountTransactionId' is not null or undefined
        if (accountTransactionId === null || accountTransactionId === undefined) {
            throw new Error('Required parameter accountTransactionId was null or undefined' +
                'when calling accountTransactionWaterMark.');
        }
        var requestOptions = {
            method: http_1.RequestMethod.Get,
            headers: headerParams,
            search: queryParameters
        };
        return this.http.request(path, requestOptions)
            .map(function (response) {
            if (response.status === 204) {
                return undefined;
            }
            else {
                return response.json();
            }
        });
    };
    return AccountTransactionApi;
}());
AccountTransactionApi = __decorate([
    core_1.Injectable(),
    __param(1, core_1.Optional()), __param(1, core_1.Inject(variables_1.ACCOUNTING_BASE_PATH)),
    __metadata("design:paramtypes", [http_1.Http, String])
], AccountTransactionApi);
exports.AccountTransactionApi = AccountTransactionApi;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWNjb3VudFRyYW5zYWN0aW9uQXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQWNjb3VudFRyYW5zYWN0aW9uQXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FxQkc7QUFFSCxzQ0FDdUM7QUFDdkMsc0NBQThEO0FBRzlELDBDQUE0RjtBQUM1RixtQkFBaUI7QUFFakIsdURBQXVEO0FBSXZELElBQWEscUJBQXFCO0lBSTlCLCtCQUFzQixJQUFVLEVBQTJDLFFBQWdCO1FBQXJFLFNBQUksR0FBSixJQUFJLENBQU07UUFIdEIsYUFBUSxHQUFHLG1FQUFtRSxDQUFDO1FBQ2xGLG1CQUFjLEdBQVksSUFBSSxjQUFPLEVBQUUsQ0FBQztRQUczQyxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ1gsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDN0IsQ0FBQztJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksd0RBQXdCLEdBQS9CLFVBQWlDLEVBQVUsRUFDekMsc0JBQTRCO1FBQzFCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLEdBQUcsbUNBQW1DO2FBQzNELE9BQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxHQUFHLEdBQUcsRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUU1QyxJQUFJLGVBQWUsR0FBRyxJQUFJLHNCQUFlLEVBQUUsQ0FBQztRQUM1QyxJQUFJLFlBQVksR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDO1FBQ3ZDLDBEQUEwRDtRQUMxRCxFQUFFLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxJQUFJLEVBQUUsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sSUFBSSxLQUFLLENBQUMsNkNBQTZDO2dCQUMzRCx3Q0FBd0MsQ0FBQyxDQUFDO1FBQ2hELENBQUM7UUFDRCxJQUFJLGNBQWMsR0FBdUI7WUFDckMsTUFB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LCtEQUErRDtnQkFDN0UsMkNBQTJDLENBQUMsQ0FBQztRQUNuRCxDQUFDO1FBQ0QsSUFBSSxjQUFjLEdBQXVCO1lBQ3JDLE1BQU0sRUFBRSxvQkFBYSxDQUFDLEdBQUc7WUFDekIsT0FBTyxFQUFFLFlBQVk7WUFDckIsTUFBTSxFQUFFLGVBQWU7U0FDMUIsQ0FBQztRQUVGLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsY0FBYyxDQUFDO2FBQ3pDLEdBQUcsQ0FBQyxVQUFDLFFBQWtCO1lBQ3BCLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQztnQkFDMUIsTUFBTSxDQUFDLFNBQVMsQ0FBQztZQUNyQixDQUFDO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ0osTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUMzQixDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDWCxDQUFDO0lBRUwsNEJBQUM7QUFBRCxDQUFDLEFBdlhELElBdVhDO0FBdlhZLHFCQUFxQjtJQURqQyxpQkFBVSxFQUFFO0lBSzBCLFdBQUEsZUFBUSxFQUFFLENBQUEsRUFBQyxXQUFBLGFBQU0sQ0FBQyxnQ0FBb0IsQ0FBQyxDQUFBO3FDQUE5QyxXQUFJO0dBSnZCLHFCQUFxQixDQXVYakM7QUF2WFksc0RBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBHdWFuUGx1cy5BY2NvdW50aW5nLldlYkFwaVxuICpcbiAqIE9wZW5BUEkgc3BlYyB2ZXJzaW9uOiB2MVxuICogXG4gKlxuICogTk9URTogVGhpcyBjbGFzcyBpcyBhdXRvIGdlbmVyYXRlZCBieSB0aGUgc3dhZ2dlciBjb2RlIGdlbmVyYXRvciBwcm9ncmFtLlxuICogaHR0cHM6Ly9naXRodWIuY29tL3N3YWdnZXItYXBpL3N3YWdnZXItY29kZWdlbi5naXRcbiAqIERvIG5vdCBlZGl0IHRoZSBjbGFzcyBtYW51YWxseS5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBIdHRwLCBIZWFkZXJzLCBSZXF1ZXN0T3B0aW9uc0FyZ3MsIFJlc3BvbnNlLCBVUkxTZWFyY2hQYXJhbXMsXG4gIFJlcXVlc3RNZXRob2QgfSBmcm9tICdAYW5ndWxhci9odHRwJztcbmltcG9ydCB7IEluamVjdGFibGUsIEluamVjdCwgT3B0aW9uYWwgfSAgZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcbmltcG9ydCAqIGFzIG1vZGVscyBmcm9tICcuLi9tb2RlbC9tb2RlbHMnO1xuaW1wb3J0IHsgQUNDT1VOVElOR19CQVNFX1BBVEggfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSAnLi4vdmFyaWFibGVzJztcbmltcG9ydCAncnhqcy9SeCc7XG5cbi8qIHRzbGludDpkaXNhYmxlOm5vLXVudXNlZC12YXJpYWJsZSBtZW1iZXItb3JkZXJpbmcgKi9cblxuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQWNjb3VudFRyYW5zYWN0aW9uQXBpIHtcbiAgICBwcm90ZWN0ZWQgYmFzZVBhdGggPSAnaHR0cDovL2d1YW5wbHVzLWFwaS1hY2NvdW50aW5nLWRldi5jbi1ub3J0aC0xLmViLmFtYXpvbmF3cy5jb20uY24nO1xuICAgIHB1YmxpYyBkZWZhdWx0SGVhZGVyczogSGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaHR0cDogSHR0cCwgQE9wdGlvbmFsKClASW5qZWN0KEFDQ09VTlRJTkdfQkFTRV9QQVRIKSBiYXNlUGF0aDogc3RyaW5nKSB7XG4gICAgICAgIGlmIChiYXNlUGF0aCkge1xuICAgICAgICAgICAgdGhpcy5iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5qC55o2uaWQg5Yig6Zmk5Lqk5piT6K6w5b2VXG4gICAgICogXG4gICAgICogQHBhcmFtIGlkIFxuICAgICAqL1xuICAgIHB1YmxpYyBhY2NvdW50VHJhbnNhY3Rpb25EZWxldGUgKGlkOiBzdHJpbmcsXG4gICAgICBleHRyYUh0dHBSZXF1ZXN0UGFyYW1zPzogYW55ICk6IE9ic2VydmFibGU8T2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hcGkvdjEvYWNjb3VudF90cmFuc2FjdGlvbi8ke2lkfSdcbiAgICAgICAgICAgIC5yZXBsYWNlKCckeycgKyAnaWQnICsgJ30nLCBTdHJpbmcoaWQpKTtcblxuICAgICAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgICBsZXQgaGVhZGVyUGFyYW1zID0gdGhpcy5kZWZhdWx0SGVhZGVycztcbiAgICAgICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnaWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAgICBpZiAoaWQgPT09IG51bGwgfHwgaWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgaWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkJyArXG4gICAgICAgICAgICAgICd3aGVuIGNhbGxpbmcgYWNjb3VudFRyYW5zYWN0aW9uRGVsZXRlLicpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXF1ZXN0T3B0aW9uczogUmVxdWVzdE9wdGlvbnNBcmdzID0ge1xuICAgICAgICAgICAgbWV0aG9kOiBSZXF1ZXN0TWV0aG9kLkRlbGV0ZSxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgICAgICAgIHNlYXJjaDogcXVlcnlQYXJhbWV0ZXJzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgICAgICAgLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDmoLnmja5pZOiOt+WPluS6pOaYk+iusOW9lVxuICAgICAqIFxuICAgICAqIEBwYXJhbSBpZCBcbiAgICAgKi9cbiAgICBwdWJsaWMgYWNjb3VudFRyYW5zYWN0aW9uR2V0IChpZDogc3RyaW5nLFxuICAgICAgZXh0cmFIdHRwUmVxdWVzdFBhcmFtcz86IGFueSApOiBPYnNlcnZhYmxlPG1vZGVscy5BY2NvdW50VHJhbnNhY3Rpb25Nb2RlbD4ge1xuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5iYXNlUGF0aCArICcvYXBpL3YxL2FjY291bnRfdHJhbnNhY3Rpb24vJHtpZH0nXG4gICAgICAgICAgICAucmVwbGFjZSgnJHsnICsgJ2lkJyArICd9JywgU3RyaW5nKGlkKSk7XG5cbiAgICAgICAgbGV0IHF1ZXJ5UGFyYW1ldGVycyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgICAgbGV0IGhlYWRlclBhcmFtcyA9IHRoaXMuZGVmYXVsdEhlYWRlcnM7XG4gICAgICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2lkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgICAgaWYgKGlkID09PSBudWxsIHx8IGlkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGlkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCcgK1xuICAgICAgICAgICAgICAnd2hlbiBjYWxsaW5nIGFjY291bnRUcmFuc2FjdGlvbkdldC4nKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IFJlcXVlc3RPcHRpb25zQXJncyA9IHtcbiAgICAgICAgICAgIG1ldGhvZDogUmVxdWVzdE1ldGhvZC5HZXQsXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICAgICAgICBzZWFyY2g6IHF1ZXJ5UGFyYW1ldGVyc1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucmVxdWVzdChwYXRoLCByZXF1ZXN0T3B0aW9ucylcbiAgICAgICAgICAgIC5tYXAoKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwNCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5LiK5Lyg5rWB5rC05biQ6ZmE5Lu2XG4gICAgICogXG4gICAgICogQHBhcmFtIGFjY291bnRUcmFuc2FjdGlvbklkIFxuICAgICAqL1xuICAgIHB1YmxpYyBhY2NvdW50VHJhbnNhY3Rpb25Nb2JpbGVVcGxvYWQgKGFjY291bnRUcmFuc2FjdGlvbklkOiBzdHJpbmcsXG4gICAgICBleHRyYUh0dHBSZXF1ZXN0UGFyYW1zPzogYW55ICk6IE9ic2VydmFibGU8QXJyYXk8bW9kZWxzLkFjY291bnRBdHRhY2htZW50TW9kZWw+PiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hcGkvdjEvYWNjb3VudF90cmFuc2FjdGlvbi9tb2JpbGUvdXBsb2FkLyR7YWNjb3VudFRyYW5zYWN0aW9uSWR9J1xuICAgICAgICAgICAgLnJlcGxhY2UoJyR7JyArICdhY2NvdW50VHJhbnNhY3Rpb25JZCcgKyAnfScsIFN0cmluZyhhY2NvdW50VHJhbnNhY3Rpb25JZCkpO1xuXG4gICAgICAgIGxldCBxdWVyeVBhcmFtZXRlcnMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICAgIGxldCBoZWFkZXJQYXJhbXMgPSB0aGlzLmRlZmF1bHRIZWFkZXJzO1xuICAgICAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhY2NvdW50VHJhbnNhY3Rpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICAgIGlmIChhY2NvdW50VHJhbnNhY3Rpb25JZCA9PT0gbnVsbCB8fCBhY2NvdW50VHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhY2NvdW50VHJhbnNhY3Rpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQnICtcbiAgICAgICAgICAgICAgJ3doZW4gY2FsbGluZyBhY2NvdW50VHJhbnNhY3Rpb25Nb2JpbGVVcGxvYWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlcXVlc3RPcHRpb25zOiBSZXF1ZXN0T3B0aW9uc0FyZ3MgPSB7XG4gICAgICAgICAgICBtZXRob2Q6IFJlcXVlc3RNZXRob2QuUG9zdCxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgICAgICAgIHNlYXJjaDogcXVlcnlQYXJhbWV0ZXJzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgICAgICAgLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDmlrDlop7kuqTmmJPorrDlvZVcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gYWNjb3VudFRyYW5zYWN0aW9uTW9kZWwgXG4gICAgICovXG4gICAgcHVibGljIGFjY291bnRUcmFuc2FjdGlvblBvc3QgKGFjY291bnRUcmFuc2FjdGlvbk1vZGVsOiBtb2RlbHMuQWNjb3VudFRyYW5zYWN0aW9uTW9kZWwsXG4gICAgICBleHRyYUh0dHBSZXF1ZXN0UGFyYW1zPzogYW55ICk6IE9ic2VydmFibGU8bW9kZWxzLkFjY291bnRUcmFuc2FjdGlvbk1vZGVsPiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hcGkvdjEvYWNjb3VudF90cmFuc2FjdGlvbic7XG5cbiAgICAgICAgbGV0IHF1ZXJ5UGFyYW1ldGVycyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgICAgbGV0IGhlYWRlclBhcmFtcyA9IHRoaXMuZGVmYXVsdEhlYWRlcnM7XG4gICAgICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FjY291bnRUcmFuc2FjdGlvbk1vZGVsJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgICAgaWYgKGFjY291bnRUcmFuc2FjdGlvbk1vZGVsID09PSBudWxsIHx8IGFjY291bnRUcmFuc2FjdGlvbk1vZGVsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFjY291bnRUcmFuc2FjdGlvbk1vZGVsIHdhcyBudWxsIG9yIHVuZGVmaW5lZCcgK1xuICAgICAgICAgICAgICAnd2hlbiBjYWxsaW5nIGFjY291bnRUcmFuc2FjdGlvblBvc3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlcXVlc3RPcHRpb25zOiBSZXF1ZXN0T3B0aW9uc0FyZ3MgPSB7XG4gICAgICAgICAgICBtZXRob2Q6IFJlcXVlc3RNZXRob2QuUG9zdCxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgICAgICAgIHNlYXJjaDogcXVlcnlQYXJhbWV0ZXJzXG4gICAgICAgIH07XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmJvZHkgPSBKU09OLnN0cmluZ2lmeShhY2NvdW50VHJhbnNhY3Rpb25Nb2RlbCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgICAgICAgLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDkv67mlLnkuqTmmJPorrDlvZVcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gYWNjb3VudFRyYW5zYWN0aW9uTW9kZWwgXG4gICAgICovXG4gICAgcHVibGljIGFjY291bnRUcmFuc2FjdGlvblB1dCAoYWNjb3VudFRyYW5zYWN0aW9uTW9kZWw6IG1vZGVscy5BY2NvdW50VHJhbnNhY3Rpb25Nb2RlbCxcbiAgICAgIGV4dHJhSHR0cFJlcXVlc3RQYXJhbXM/OiBhbnkgKTogT2JzZXJ2YWJsZTxtb2RlbHMuQWNjb3VudFRyYW5zYWN0aW9uTW9kZWw+IHtcbiAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FwaS92MS9hY2NvdW50X3RyYW5zYWN0aW9uJztcblxuICAgICAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgICBsZXQgaGVhZGVyUGFyYW1zID0gdGhpcy5kZWZhdWx0SGVhZGVycztcbiAgICAgICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWNjb3VudFRyYW5zYWN0aW9uTW9kZWwnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAgICBpZiAoYWNjb3VudFRyYW5zYWN0aW9uTW9kZWwgPT09IG51bGwgfHwgYWNjb3VudFRyYW5zYWN0aW9uTW9kZWwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWNjb3VudFRyYW5zYWN0aW9uTW9kZWwgd2FzIG51bGwgb3IgdW5kZWZpbmVkJyArXG4gICAgICAgICAgICAgICd3aGVuIGNhbGxpbmcgYWNjb3VudFRyYW5zYWN0aW9uUHV0LicpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXF1ZXN0T3B0aW9uczogUmVxdWVzdE9wdGlvbnNBcmdzID0ge1xuICAgICAgICAgICAgbWV0aG9kOiBSZXF1ZXN0TWV0aG9kLlB1dCxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgICAgICAgIHNlYXJjaDogcXVlcnlQYXJhbWV0ZXJzXG4gICAgICAgIH07XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmJvZHkgPSBKU09OLnN0cmluZ2lmeShhY2NvdW50VHJhbnNhY3Rpb25Nb2RlbCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgICAgICAgLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDmoLnmja5pZOaSpOmUgOaUtuaUr+iusOW9lVxuICAgICAqIFxuICAgICAqIEBwYXJhbSBhY2NvdW50VHJhbnNhY3Rpb25JZHMg5pS25pSv6K6w5b2VaWTpm4blkIhcbiAgICAgKi9cbiAgICBwdWJsaWMgYWNjb3VudFRyYW5zYWN0aW9uUmV2b2tlIChhY2NvdW50VHJhbnNhY3Rpb25JZHM6IEFycmF5PHN0cmluZz4sXG4gICAgICBleHRyYUh0dHBSZXF1ZXN0UGFyYW1zPzogYW55ICk6IE9ic2VydmFibGU8T2JqZWN0PiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hcGkvdjEvYWNjb3VudF90cmFuc2FjdGlvbi9yZXZva2UnO1xuXG4gICAgICAgIGxldCBxdWVyeVBhcmFtZXRlcnMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICAgIGxldCBoZWFkZXJQYXJhbXMgPSB0aGlzLmRlZmF1bHRIZWFkZXJzO1xuICAgICAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhY2NvdW50VHJhbnNhY3Rpb25JZHMnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAgICBpZiAoYWNjb3VudFRyYW5zYWN0aW9uSWRzID09PSBudWxsIHx8IGFjY291bnRUcmFuc2FjdGlvbklkcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhY2NvdW50VHJhbnNhY3Rpb25JZHMgd2FzIG51bGwgb3IgdW5kZWZpbmVkJyArXG4gICAgICAgICAgICAgICd3aGVuIGNhbGxpbmcgYWNjb3VudFRyYW5zYWN0aW9uUmV2b2tlLicpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXF1ZXN0T3B0aW9uczogUmVxdWVzdE9wdGlvbnNBcmdzID0ge1xuICAgICAgICAgICAgbWV0aG9kOiBSZXF1ZXN0TWV0aG9kLlBvc3QsXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICAgICAgICBzZWFyY2g6IHF1ZXJ5UGFyYW1ldGVyc1xuICAgICAgICB9O1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5ib2R5ID0gSlNPTi5zdHJpbmdpZnkoYWNjb3VudFRyYW5zYWN0aW9uSWRzKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QocGF0aCwgcmVxdWVzdE9wdGlvbnMpXG4gICAgICAgICAgICAubWFwKChyZXNwb25zZTogUmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOWIhumhteiOt+WPluS6pOaYk+iusOW9lVxuICAgICAqIFxuICAgICAqIEBwYXJhbSBiYW5rYWNjb3VudGlkIOmTtuihjOi0puaIt0lkXG4gICAgICogQHBhcmFtIGFjY291bnRUcmFuc2FjdGlvblR5cGUg5Lqk5piT57G75Z6L77yaMOOAgeWFqOmDqO+8mzHjgIHmlLblhaXvvJsy44CB5pSv5Ye6XG4gICAgICogQHBhcmFtIGtleXdvcmQg5YWz6ZSu5a2XXG4gICAgICogQHBhcmFtIG1vbmV5IOmHkeminVxuICAgICAqIEBwYXJhbSBzdGFydERhdGUg5byA5aeL5pe26Ze0XG4gICAgICogQHBhcmFtIGVuZERhdGUg57uT5p2f5pe26Ze0XG4gICAgICogQHBhcmFtIGluY2x1ZGVDaGlsZHJlbiDmmK/lkKbluKblrZDpoblZL05cbiAgICAgKiBAcGFyYW0gc3RhdGVtZW50U3RhdHVzIOWvuei0pueKtuaAge+8mjDmiJbogIXnqbrlrZfnrKbkuLImI3gzRDvlhajpg6jvvJsxJiN4M0Q75pyq5a+56LSm77ybMiYjeDNEO+W3sue7j+Wvuei0plxuICAgICAqIEBwYXJhbSBtYXRjaE1vbmV5IOWMuemFjemHkeminVxuICAgICAqIEBwYXJhbSBwYWdlSW5kZXgg6aG15pWw57Si5byVXG4gICAgICogQHBhcmFtIHBhZ2VTaXplIOmhteaVsOWkp+Wwj1xuICAgICAqL1xuICAgIHB1YmxpYyBhY2NvdW50VHJhbnNhY3Rpb25TZWFyY2ggKGJhbmthY2NvdW50aWQ6IHN0cmluZyxcbiAgICAgIGFjY291bnRUcmFuc2FjdGlvblR5cGU/OiBzdHJpbmcsXG4gICAgICBrZXl3b3JkPzogc3RyaW5nLFxuICAgICAgbW9uZXk/OiBzdHJpbmcsXG4gICAgICBzdGFydERhdGU/OiBzdHJpbmcsXG4gICAgICBlbmREYXRlPzogc3RyaW5nLFxuICAgICAgaW5jbHVkZUNoaWxkcmVuPzogc3RyaW5nLFxuICAgICAgc3RhdGVtZW50U3RhdHVzPzogc3RyaW5nLFxuICAgICAgbWF0Y2hNb25leT86IHN0cmluZyxcbiAgICAgIHBhZ2VJbmRleD86IHN0cmluZyxcbiAgICAgIHBhZ2VTaXplPzogc3RyaW5nLFxuICAgICAgZXh0cmFIdHRwUmVxdWVzdFBhcmFtcz86IGFueSApOiBPYnNlcnZhYmxlPG1vZGVscy5QYWdlZFJlc3VsdEFjY291bnRUcmFuc2FjdGlvbk1vZGVsPiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hcGkvdjEvYWNjb3VudF90cmFuc2FjdGlvbi9zZWFyY2gvJHtiYW5rYWNjb3VudGlkfSdcbiAgICAgICAgICAgIC5yZXBsYWNlKCckeycgKyAnYmFua2FjY291bnRpZCcgKyAnfScsIFN0cmluZyhiYW5rYWNjb3VudGlkKSk7XG5cbiAgICAgICAgbGV0IHF1ZXJ5UGFyYW1ldGVycyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgICAgbGV0IGhlYWRlclBhcmFtcyA9IHRoaXMuZGVmYXVsdEhlYWRlcnM7XG4gICAgICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2JhbmthY2NvdW50aWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAgICBpZiAoYmFua2FjY291bnRpZCA9PT0gbnVsbCB8fCBiYW5rYWNjb3VudGlkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGJhbmthY2NvdW50aWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkJyArXG4gICAgICAgICAgICAgICd3aGVuIGNhbGxpbmcgYWNjb3VudFRyYW5zYWN0aW9uU2VhcmNoLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY2NvdW50VHJhbnNhY3Rpb25UeXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1ldGVycy5zZXQoJ2FjY291bnRUcmFuc2FjdGlvblR5cGUnLCBTdHJpbmcoYWNjb3VudFRyYW5zYWN0aW9uVHlwZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGtleXdvcmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzLnNldCgna2V5d29yZCcsIFN0cmluZyhrZXl3b3JkKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobW9uZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzLnNldCgnbW9uZXknLCBTdHJpbmcobW9uZXkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdGFydERhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzLnNldCgnc3RhcnREYXRlJywgU3RyaW5nKHN0YXJ0RGF0ZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVuZERhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzLnNldCgnZW5kRGF0ZScsIFN0cmluZyhlbmREYXRlKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5jbHVkZUNoaWxkcmVuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1ldGVycy5zZXQoJ2luY2x1ZGVDaGlsZHJlbicsIFN0cmluZyhpbmNsdWRlQ2hpbGRyZW4pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdGF0ZW1lbnRTdGF0dXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzLnNldCgnc3RhdGVtZW50U3RhdHVzJywgU3RyaW5nKHN0YXRlbWVudFN0YXR1cykpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1hdGNoTW9uZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzLnNldCgnbWF0Y2hNb25leScsIFN0cmluZyhtYXRjaE1vbmV5KSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFnZUluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1ldGVycy5zZXQoJ3BhZ2VJbmRleCcsIFN0cmluZyhwYWdlSW5kZXgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYWdlU2l6ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtZXRlcnMuc2V0KCdwYWdlU2l6ZScsIFN0cmluZyhwYWdlU2l6ZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlcXVlc3RPcHRpb25zOiBSZXF1ZXN0T3B0aW9uc0FyZ3MgPSB7XG4gICAgICAgICAgICBtZXRob2Q6IFJlcXVlc3RNZXRob2QuR2V0LFxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxuICAgICAgICAgICAgc2VhcmNoOiBxdWVyeVBhcmFtZXRlcnNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QocGF0aCwgcmVxdWVzdE9wdGlvbnMpXG4gICAgICAgICAgICAubWFwKChyZXNwb25zZTogUmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOS4iuS8oOa1geawtOW4kOmZhOS7tlxuICAgICAqIFxuICAgICAqIEBwYXJhbSBhY2NvdW50VHJhbnNhY3Rpb25JZCBcbiAgICAgKi9cbiAgICBwdWJsaWMgYWNjb3VudFRyYW5zYWN0aW9uVXBsb2FkIChhY2NvdW50VHJhbnNhY3Rpb25JZDogc3RyaW5nLFxuICAgICAgZXh0cmFIdHRwUmVxdWVzdFBhcmFtcz86IGFueSApOiBPYnNlcnZhYmxlPEFycmF5PG1vZGVscy5BY2NvdW50QXR0YWNobWVudE1vZGVsPj4ge1xuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5iYXNlUGF0aCArICcvYXBpL3YxL2FjY291bnRfdHJhbnNhY3Rpb24vdXBsb2FkLyR7YWNjb3VudFRyYW5zYWN0aW9uSWR9J1xuICAgICAgICAgICAgLnJlcGxhY2UoJyR7JyArICdhY2NvdW50VHJhbnNhY3Rpb25JZCcgKyAnfScsIFN0cmluZyhhY2NvdW50VHJhbnNhY3Rpb25JZCkpO1xuXG4gICAgICAgIGxldCBxdWVyeVBhcmFtZXRlcnMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICAgIGxldCBoZWFkZXJQYXJhbXMgPSB0aGlzLmRlZmF1bHRIZWFkZXJzO1xuICAgICAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhY2NvdW50VHJhbnNhY3Rpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICAgIGlmIChhY2NvdW50VHJhbnNhY3Rpb25JZCA9PT0gbnVsbCB8fCBhY2NvdW50VHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhY2NvdW50VHJhbnNhY3Rpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQnICtcbiAgICAgICAgICAgICAgJ3doZW4gY2FsbGluZyBhY2NvdW50VHJhbnNhY3Rpb25VcGxvYWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlcXVlc3RPcHRpb25zOiBSZXF1ZXN0T3B0aW9uc0FyZ3MgPSB7XG4gICAgICAgICAgICBtZXRob2Q6IFJlcXVlc3RNZXRob2QuUG9zdCxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgICAgICAgIHNlYXJjaDogcXVlcnlQYXJhbWV0ZXJzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgICAgICAgLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDojrflj5bmsLTljbBcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gYXR0YWNobWVudElkIOmZhOS7tmlkXG4gICAgICogQHBhcmFtIGFjY291bnRUcmFuc2FjdGlvbklkIOS6pOaYk+iusOW9lWlkXG4gICAgICovXG4gICAgcHVibGljIGFjY291bnRUcmFuc2FjdGlvbldhdGVyTWFyayAoYXR0YWNobWVudElkOiBzdHJpbmcsXG4gICAgICBhY2NvdW50VHJhbnNhY3Rpb25JZDogc3RyaW5nLFxuICAgICAgZXh0cmFIdHRwUmVxdWVzdFBhcmFtcz86IGFueSApOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5iYXNlUGF0aCArICcvYXBpL3YxL2FjY291bnRfdHJhbnNhY3Rpb24vJHthdHRhY2htZW50SWR9LyR7YWNjb3VudFRyYW5zYWN0aW9uSWR9L3dhdGVybWFyaydcbiAgICAgICAgICAgIC5yZXBsYWNlKCckeycgKyAnYXR0YWNobWVudElkJyArICd9JywgU3RyaW5nKGF0dGFjaG1lbnRJZCkpXG4gICAgICAgICAgICAucmVwbGFjZSgnJHsnICsgJ2FjY291bnRUcmFuc2FjdGlvbklkJyArICd9JywgU3RyaW5nKGFjY291bnRUcmFuc2FjdGlvbklkKSk7XG5cbiAgICAgICAgbGV0IHF1ZXJ5UGFyYW1ldGVycyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgICAgbGV0IGhlYWRlclBhcmFtcyA9IHRoaXMuZGVmYXVsdEhlYWRlcnM7XG4gICAgICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2F0dGFjaG1lbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICAgIGlmIChhdHRhY2htZW50SWQgPT09IG51bGwgfHwgYXR0YWNobWVudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGF0dGFjaG1lbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQnICtcbiAgICAgICAgICAgICAgJ3doZW4gY2FsbGluZyBhY2NvdW50VHJhbnNhY3Rpb25XYXRlck1hcmsuJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWNjb3VudFRyYW5zYWN0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAgICBpZiAoYWNjb3VudFRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgYWNjb3VudFRyYW5zYWN0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWNjb3VudFRyYW5zYWN0aW9uSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkJyArXG4gICAgICAgICAgICAgICd3aGVuIGNhbGxpbmcgYWNjb3VudFRyYW5zYWN0aW9uV2F0ZXJNYXJrLicpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXF1ZXN0T3B0aW9uczogUmVxdWVzdE9wdGlvbnNBcmdzID0ge1xuICAgICAgICAgICAgbWV0aG9kOiBSZXF1ZXN0TWV0aG9kLkdldCxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgICAgICAgIHNlYXJjaDogcXVlcnlQYXJhbWV0ZXJzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHBhdGgsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgICAgICAgLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn1cbiJdfQ==